{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://certeus/schemas/provenance_receipt_v1.json",
  "title": "Certeus - Dowód Pochodzenia v1 / Provenance Receipt v1",
  "description": "PL: Kryptograficzny 'paragon' dokumentujący genezę odpowiedzi (wejścia, solvery, skróty). EN: A cryptographic 'receipt' documenting the origin of an answer (inputs, solvers, hashes).",
  "type": "object",
  "additionalProperties": false,
  "$defs": {
    "uuid": {
      "type": "string",
      "description": "PL: UUID (dowolnej wersji). EN: UUID (any version).",
      "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
    },
    "sha256": {
      "type": "string",
      "description": "PL: Skrót SHA-256 w hex. EN: SHA-256 hex digest.",
      "pattern": "^[A-Fa-f0-9]{64}$"
    },
    "solverRecord": {
      "type": "object",
      "description": "PL: Wynik i metadane solvera. EN: Solver result and metadata.",
      "additionalProperties": false,
      "properties": {
        "status": {
          "type": "string",
          "description": "PL: Status wykonania. EN: Execution status.",
          "enum": ["ok", "error", "timeout"]
        },
        "proof_path": {
          "type": "string",
          "description": "PL: Ścieżka/URI do dowodu. EN: Path/URI to the proof."
        },
        "proof_hash": {
          "$ref": "#/$defs/sha256",
          "description": "PL: Hash wygenerowanego dowodu. EN: Hash of the generated proof."
        },
        "runtime_ms": {
          "type": "integer",
          "description": "PL: Czas wykonania w ms. EN: Execution time in ms.",
          "minimum": 0
        },
        "meta": {
          "type": "object",
          "description": "PL: Dowolne metadane solvera. EN: Arbitrary solver metadata."
        }
      },
      "required": ["status"]
    }
  },
  "properties": {
    "case_id": {
      "type": "string",
      "description": "PL: Unikalny identyfikator sprawy. EN: Unique case identifier."
    },
    "receipt_id": {
      "$ref": "#/$defs/uuid",
      "description": "PL: Unikalny identyfikator paragonu pochodzenia. EN: Unique provenance receipt ID."
    },
    "inputs": {
      "type": "object",
      "description": "PL: Dane wejściowe użyte do analizy. EN: Input data used for the analysis.",
      "additionalProperties": false,
      "properties": {
        "lexlog_rule_version": {
          "type": "string",
          "description": "PL: Wersja reguły LEXLOG. EN: Version of the LEXLOG rule."
        },
        "assumptions_hash": {
          "$ref": "#/$defs/sha256",
          "description": "PL: Skrót użytych założeń. EN: Hash of the assumptions used."
        },
        "question_hash": {
          "$ref": "#/$defs/sha256",
          "description": "PL: Skrót treści pytania. EN: Hash of the question text."
        }
      },
      "required": ["lexlog_rule_version", "assumptions_hash"]
    },
    "solvers": {
      "type": "object",
      "description": "PL: Wyniki i metadane z poszczególnych solverów. EN: Results and metadata from individual solvers.",
      "additionalProperties": false,
      "properties": {
        "z3": { "$ref": "#/$defs/solverRecord" },
        "cvc5": { "$ref": "#/$defs/solverRecord" }
      }
    },
    "mismatch": {
      "type": "boolean",
      "description": "PL: Czy solverzy się nie zgadzają. EN: Do solvers disagree."
    },
    "final_hash": {
      "$ref": "#/$defs/sha256",
      "description": "PL: Ostateczny skrót całego obiektu odpowiedzi. EN: Final hash of the entire answer object."
    },
    "timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "PL: Znacznik czasu wygenerowania dowodu. EN: Timestamp of when the receipt was generated."
    }
  },
  "required": [
    "case_id",
    "inputs",
    "solvers",
    "mismatch",
    "final_hash",
    "timestamp"
  ]
}

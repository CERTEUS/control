FROM node:22-bookworm

# System deps (Python do test√≥w, Git, curl, certy)
RUN apt-get update -o Acquire::Retries=3 -o Acquire::http::Timeout="60" && \
    apt-get install -y --no-install-recommends \
      git openssh-client ripgrep \
      python3 python3-pip python3-venv ca-certificates curl && \
    rm -rf /var/lib/apt/lists/*

# Codex CLI (globalnie)
RUN npm i -g @openai/codex@latest

ENV CODEX_HOME=/root/.codex
WORKDIR /workspace
